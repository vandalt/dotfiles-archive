#!/bin/bash

# Add external monitor on right or left
intern=eDP1
extern=HDMI1

# Check if HiDPI
dpi=$(xrdb -query | grep dpi | grep -o -E '[0-9]*')
if [ $dpi -eq 192 ]; then
    scale="2x2"
else
    scale="1x1"
fi

# Get width of each monitor (adapt scale of external for HiDPI)
wext=$(xrandr | grep -A 1 "$extern" | grep + | awk '{print $1;}' | cut -d x -f 1)
wint=$(xrandr | grep -A 1 "$intern" | grep + | awk '{print $1;}' | cut -d x -f 1)
wext=$(( $wext * $(echo $scale | cut -d x -f 1) ))

if [ "$#" -eq 0 ]; then
    xrandr --output "$intern" --auto --output "$extern" --auto --scale "$scale" --right-of "$intern"
elif [ $1 == "-l" ]; then
    xrandr --output "$intern" --auto  --pos "$wext"x0 --output "$extern" --auto --scale "$scale"
else
    xrandr --output "$intern" --auto --output "$extern" --auto --scale "$scale" --right-of "$intern"
fi
